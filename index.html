<!DOCTYPE html>
<html lang="fr">
<head>
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Power Family Présences</title>
    <style>
        /* ... vos styles CSS existants ... */
    </style>
    </head>
<body>
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-analytics.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries

      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyDpQ0w3azdx8Gl6K5GDVACzZi2eBm63wVw",
        authDomain: "presences-hmb-tech.firebaseapp.com",
        projectId: "presences-hmb-tech",
        storageBucket: "presences-hmb-tech.firebasestorage.app",
        messagingSenderId: "106820587993",
        appId: "1:106820587993:web:b5adf2e81bb5c8359a09c8",
        measurementId: "G-Z28D2R4FQC"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
    </script>
</body>
</html>
    <meta charset="UTF-8">
    <title>Power Family Présences</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        /* Style pour le conteneur du tableau pour le centrer */
        .table-container {
            display: flex; /* Utilisation de flexbox pour le centrage */
            justify-content: center; /* Centrer horizontalement */
            margin-left: 3mm; /* Marge à gauche de 3mm */
            margin-right: 3mm; /* Marge à droite de 3mm */
            width: auto; /* Ajuster la largeur automatiquement au contenu */
        }

        table {
            border-collapse: collapse;
            margin-bottom: 20px;
            width: 100%; /* Le tableau prend 100% de la largeur de son conteneur */
            max-width: 1000px; /* Optionnel : pour limiter la largeur maximale du tableau si nécessaire */
        }
        th, td { border: 1px solid #C0C0C0; padding: 5px; text-align: left; }
        .code-input { width: 29px; text-align: center; }

        /* Couleurs des lignes */
        tr:nth-child(3n+1) { background-color: #B0E2FF; }
        tr:nth-child(3n+2) { background-color: #21618c; }
        tr:nth-child(3n+3) { background-color: #B0E2FF; }

        .valid { background-color: #B0E2FF !important; }
        .invalid { background-color: #FF0000 !important; }

        /* Style du bouton */
        #printBtn {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        #totalSection {
            margin: 20px 0;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }

        /* Styles pour les nouvelles sections de listes */
        .present-students-section, .absent-students-section {
            margin-top: 30px;
            padding: 15px;
            border-radius: 5px;
        }

        .present-students-section {
            background-color: rgba(173, 216, 230, 0.3); /* Bleu transparent */
        }

        .absent-students-section {
            background-color: rgba(255, 182, 193, 0.3); /* Rose transparent */
        }

        .present-students-section h3, .absent-students-section h3 {
            margin-top: 0;
        }
         .fraude-students-section {
            margin-top: 30px;
            padding: 15px;
            background-color: #ffe0b2;
            border-radius: 5px;
        }
         .fraude-students-section h3 {
            margin-top: 0;
        } 
<!-- Ajoutez ce bouton dans votre HTML -->
<button onclick="generatePresencePDF()" 
        style="position: fixed; bottom: 200px; right: 20px; padding: 10px; background: #B0E2FF; color: B0E2FF;">
    ⎙
</button>

<!-- Ajoutez ces scripts en bas de body -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

<script>
function generatePresencePDF() {
    const doc = new jspdf.jsPDF({
        orientation: 'PORTRAIT',
        unit: 'mm',
        format: 'a4'
    });

    // Configuration du PDF
    const title = "RAPPORT DES PRÉSENCES PRÉPA H-25 - " + new Date().toLocaleDateString();
    const headers = [["N°", "Nom", "Statut"]];
    const rows = [];

    // Récupération des données du tableau
    const tableRows = document.querySelectorAll('#studentList tr');
    
    tableRows.forEach((row, index) => {
        const cells = row.querySelectorAll('td');
        const status = cells[3].textContent; // Colonne Statut
        const rowData = [
            index + 1,
            cells[1].textContent, // Nom        cells[2].querySelector('code-input')?.value  || 'N/A', // Code saisi
            status
        ];
        rows.push(rowData);
    });

    // Génération du tableau PDF
    doc.autoTable({
        head: headers,
        body: rows,
        theme: 'grid',
        styles: { fontSize: 10 },
        headerStyles: { fillColor: [33, 150, 243] },
        alternateRowStyles: { fillColor: [240, 240, 240] },
        margin: { top: 20 },
        didDrawPage: function(data) {
            // En-tête avec date
            doc.setFontSize(12);
            doc.text(title, 14, 10);
            
            // Pied de page
            const pageCount = doc.internal.getNumberOfPages();
            doc.setFontSize(8);
            doc.text(`Page ${data.pageNumber}/${pageCount} - © HMB-TECH ${new Date().getFullYear()}`, 
                     data.settings.margin.left, doc.internal.pageSize.height - 5);
        }
    });

    doc.save(`presences-${Date.now()}.pdf`);
}
</script>

<!-- Bouton rond pour télécharger le PDF des statistiques -->
<button onclick="genererStatsPDF()" 
        style="position: fixed; 
               right: 20px; 
               bottom: 20px; 
               width: 50px; 
               height: 50px;
               background: #0077B5;
               color: white;
               border: none;
               border-radius: 50%;
               cursor: pointer;
               font-size: 16px;">
    ⎙
</button>

<!-- Inclusion de jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

<script>
function genererStatsPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    // Titre du document
    doc.setFontSize(14);
    doc.text("Statistiques de Présence", 14, 10);

    // Récupération des listes d'étudiants
    const presents = Array.from(document.getElementById('presentStudentList').children).map(li => [li.textContent]);
    const absents = Array.from(document.getElementById('absentStudentList').children).map(li => [li.textContent]);
    const fraudes = Array.from(document.getElementById('fraudeStudentList').children).map(li => [li.textContent]);

    // Déterminer le nombre maximum de lignes
    const maxRows = Math.max(presents.length, absents.length, fraudes.length);
    const rows = [];

    for (let i = 0; i < maxRows; i++) {
        rows.push([
            absents[i] ? absents[i][0] : '',
            presents[i] ? presents[i][0] : '',
            fraudes[i] ? fraudes[i][0] : ''
        ]);
    }

    // Génération du tableau PDF
    doc.autoTable({
        head: [["Absents", "Présents", "Fraudes"]],
        body: rows,
        startY: 20,
        theme: 'grid',
        styles: { fontSize: 10 },
        columnStyles: { 0: { cellWidth: 60 }, 1: { cellWidth: 60 }, 2: { cellWidth: 60 } }
    });

    // Enregistrement du fichier PDF
    doc.save("statistiques_presences.pdf");
}
    </style>
</head>

<!DOCTYPE html>
<html>
<head>
<style>
.rdc-banner {
    position: relative;
    width: 100%;
    height: 1cm;
    overflow: hidden;
}

.color-wave {
    width: 300%;
    height: 100%;
    background: linear-gradient(
        to right,
        #0077B5,
        #0077B5 33.33%,
        #FFD700 33.33%,
        #FFD700 66.66%,
        #CE1126 66.66%,
        #CE1126 100%
    );
    animation: slide 10s linear infinite;
}

@keyframes slide {
    0% { transform: translateX(-66.66%); }
    100% { transform: translateX(0); }
}

/* --- Styles à ajouter pour le tableau avec espacement de 1cm --- */
.table-container table {
    border-spacing: 0 1cm; /* Espacement vertical entre les lignes de 1cm */
    border-radius: 8px; /* Bordures rondes pour le tableau */
    overflow: hidden; /* Important pour que les bordures rondes fonctionnent avec l'espacement */
}

.table-container th {
    background-color: #0D1C40; /* Couleur de l'entête du site */
    color: white; /* Assurez-vous que le texte de l'entête est lisible */
    padding: 8px; /* Conservez le padding existant ou ajustez-le */
    text-align: left; /* Conservez l'alignement du texte */
}

.table-container thead tr th:first-child {
    border-top-left-radius: 8px;
}

.table-container thead tr th:last-child {
    border-top-right-radius: 8px;
}

.table-container tbody tr {
    background-color: rgba(13, 28, 64, 0.05); /* Fond légèrement transparent pour les lignes */
    border-radius: 8px; /* Bordures rondes pour les lignes */
}

.table-container tbody tr td:first-child {
    border-bottom-left-radius: 8px;
}

.table-container tbody tr td:last-child {
    border-bottom-right-radius: 8px;
}

.table-container td {
    padding: 8px; /* Conservez le padding existant ou ajustez-le */
}
</style>
</head>
<body>

<div class="rdc-banner">
    <div class="color-wave"></div>
</div>

</body>
</html>


    <h2>LISTE DES PRÉSENCES</h2>

    <div class="table-container">  <table>
            <thead>
                <tr>
                    <th>N°</th>
                    <th>Nom</th>
                    <th>Code</th>
                    <th>Statut</th>
                </tr>
            </thead>
            <tbody id="studentList">
                </tbody>
        </table>
    </div>


    <div style="margin: 20px 0; padding: 15px; background: #f5f5f5; border-radius: 5px;">
        <h3>Statistiques en temps réel</h3>
        <div style="display: flex; gap: 20px;">
            <div style="padding: 10px; background: #d4edda; border-radius: 5px;">
                Présents: <span id="totalPresent">0</span>
            </div>
            <div style="padding: 10px; background: #fff3cd; border-radius: 5px;">
                Absents: <span id="totalAbsent">0</span>
            </div>
            <div style="padding: 10px; background: #f8d7da; border-radius: 5px;">
                Frauduleux: <span id="totalFraude">0</span>
            </div>
        </div>
    </div>

    <div class="fraude-students-section">
        <h3>Étudiants avec code erroné</h3>
        <ul id="fraudeStudentList">
            </ul>
    </div>

    <div class="present-students-section">
        <h3>Liste des étudiants présents</h3>
        <ul id="presentStudentList">
        </ul>
    </div>

    <div class="absent-students-section">
        <h3>Liste des étudiants absents</h3>
        <ul id="absentStudentList">
        </ul>
    </div>


    <script>
        // Liste complète des élèves avec codes AAA000+
        const students = [
            { name: "IBEMBA – NTEMBI", code: "AAA000" },
            { name: "KITAMBWE - MUDIMBI", code: "AAA001" },
            { name: "MBALA - LUBAKI", code: "AAA002" },
            { name: "MBALA - MBIMBA", code: "AAA003" },
            { name: "MBAMBINA - WAZANGBA", code: "AAA004" },
            { name: "MBANDJO – IYELE", code: "AAA005" },
            { name: "MBATU - KIMWANGA", code: "AAA006" },
            { name: "MBAYA – BAYA – HANS", code: "AAA007" },
            { name: "MBAYA – FAUSTIN", code: "AAA008" },
            { name: "MBAYO – BONONGE", code: "AAA009" },
            { name: "MBEKU – ELEKWA", code: "AAA010" },
            { name: "MBELE – KALUSUTI", code: "AAA011" },
            { name: "MBELENGA-MBOMBAWANDE", code: "AAA012" },
            { name: "MBEMA – ZONGO", code: "AAA013" },
            { name: "MBEMBA – KUKU – MIRADIE", code: "AAA014" },
            { name: "MBENGI – MBO", code: "AAA015" },
            { name: "MBIMBA - MUFUNGIZI", code: "AAA016" },
            { name: "MBIRIZE - IMANI", code: "AAA017" },
            { name: "MBO – MFUMU", code: "AAA018" },
            { name: "MBO – WEMBA", code: "AAA019" },
            { name: "MBOBO – LUPOMBO", code: "AAA020" },
            { name: "MBOKO –NTOKO", code: "AAA021" },
            { name: "MBOLOLO – MWIMPE", code: "AAA022" },
            { name: "MBOMA – KALAMBA", code: "AAA023" },
            { name: "MBOMA – NDOSALA", code: "AAA024" },
            { name: "MBOMA – TAUBALA", code: "AAA025" },
            { name: "MBOSO – MAWETE", code: "AAA026" },
            { name: "MBUAKI - MIEZI", code: "AAA027" },
            { name: "MBUBA - NDONGALA", code: "AAA028" },
            { name: "MBUEZO – LUNGENY", code: "AAA029" },
            { name: "MBUKA - MATUVANG", code: "AAA030" },
            { name: "MBUKU – KISALU", code: "AAA031" },
            { name: "MBULA – MBANZA", code: "AAA032" },
            { name: "MBULAYI - TSHIBANGU", code: "AAA033" },
            { name: "MBUMBA – NDEMBE", code: "AAA034" },
            { name: "MBUYA - MUJANI", code: "AAA035" },
            { name: "MBUYAMBA - TSHISWAKA", code: "AAA036" },
            { name: "MBUYI – KOLE", code: "AAA037" },
            { name: "MBUYI – NDAYE", code: "AAA038" },
            { name: "MBWELIMA - TANGA", code: "AAA039" },
            { name: "MBWITI - KUYAKANA", code: "AAA040" },
            { name: "MEKANDA – IWOKO", code: "AAA041" },
            { name: "MENEMENE – NKOSI", code: "AAA042" },
            { name: "MENGA - MABALA", code: "AAA043" },
            { name: "MESA – MUSALU", code: "AAA044" },
            { name: "MFULUNGANI -NFULAMESO", code: "AAA045" },
            { name: "MIANTISE – NDOOLE", code: "AAA046" },
            { name: "MIBO – MPEWA", code: "AAA047" },
            { name: "MIKADI – MIKADI", code: "AAA048" },
            { name: "MIKOBI – BELAPIO", code: "AAA049" },
            { name: "MIKUBA – ALFANI", code: "AAA050" },
            { name: "MILONGA - MUDIMBANYA", code: "AAA051" },
            { name: "MILUMBU – KABUYA", code: "AAA052" },
            { name: "MINGA – KWETE", code: "AAA053" },
            { name: "MINGA – MBATSHI", code: "AAA054" },
            { name: "MINGA – PONGO", code: "AAA055" },
            { name: "MIOMA – KINGOMBE", code: "AAA056" },
            { name: "MIOMO – MAKANDA", code: "AAA057" },
            { name: "MISENGABU - TEGRA", code: "AAA058" },
            { name: "MISIONO – MVUNGU", code: "AAA059" },
            { name: "MITSHIABU - ILUNGA", code: "AAA060" },
            { name: "MITUNGA - MUBIANGAT", code: "AAA061" },
            { name: "MITUNGINI – LUZOLO", code: "AAA062" },
            { name: "MOBAO – MOPIA", code: "AAA063" },
            { name: "MOBONDA - BOYELE", code: "AAA064" },
            { name: "MODJA – ETOTI", code: "AAA065" },
            { name: "MOGBOKULA-NDOLE", code: "AAA066" },
            { name: "MOHELE – MATUKA", code: "AAA067" },
            { name: "MOKIE - INKINI", code: "AAA068" },
            { name: "MOKILI - KATSHULU", code: "AAA069" },
            { name: "MOKOSI – KETA", code: "AAA070" },
            { name: "MOKOYO-BOKIANGA", code: "AAA071" },
            { name: "MOKUBA – BAPELE", code: "AAA072" },
            { name: "MOKUTU – GOLO", code: "AAA073" },
            { name: "MOLITHIO – NDOPO", code: "AAA074" },
            { name: "MOMELE – BOKILA", code: "AAA075" },
            { name: "MONGA - MOKESA", code: "AAA076" },
            { name: "MONGBANI – AKOSU", code: "AAA077" },
            { name: "MONSENGO-MAFISANGO", code: "AAA078" },
            { name: "MONSENGO - NTWABOY", code: "AAA079" },
            { name: "MOONGO - BOMPUSA", code: "AAA080" },
            { name: "MOPAYI – BOKUNGU", code: "AAA081" },
            { name: "MOPIA - BENIE", code: "AAA082" },
            { name: "MOPINI – NGOBILA", code: "AAA083" },
            { name: "MOPOLO – LENGO", code: "AAA084" },
            { name: "MOTOKWA - DIDO", code: "AAA085" },
            { name: "MOUTSIEKOU - PANDI", code: "AAA086" },
            { name: "MOWENI – BOPOPI", code: "AAA087" },
            { name: "MPAMALEO - BOSONTIA", code: "AAA088" },
            { name: "MPANA - NGAMBIELI", code: "AAA089" },
            { name: "MPATA - LITUMBE", code: "AAA090" },
            { name: "MPAY – NKE", code: "AAA091" },
            { name: "MPELA – BAWESI", code: "AAA092" },
            { name: "MPEMBE – BASSA", code: "AAA093" },
            { name: "MPENGELE – PONGO", code: "AAA094" },
            { name: "MPETSHI - BANGONGO", code: "AAA095" },
            { name: "MPEYA – LINGONGO", code: "AAA096" },
            { name: "MWANGANI - KATIMUKA", code: "AAA097" },
            { name: "NOYO – MUKENDI", code: "AAA098" }
        ];

        let fraudeStudents = []; // Tableau pour stocker les étudiants frauduleux
        let presentStudents = []; // Tableau pour stocker les étudiants présents
        let absentStudents = []; // Tableau pour stocker les étudiants absents


        function renderList() {
            const tbody = document.getElementById('studentList');
            tbody.innerHTML = students.map((student, index) => `
                <tr id="row-${index}">
                    <td>${index + 1}</td>
                    <td>${student.name}</td>
                    <td>
                        <input class="code-input" type="password"
                               oninput="validateCode(${index}, this.value)">
                        <span id="status-${index}" style="display:none;">Présent</span>
                    </td>
                    <td id="textStatus-${index}">Absent</td>
                </tr>
            `).join('');
        }

        function updateTotals() {
            let present = 0, absent = 0, fraude = 0;
            presentStudents = []; // Réinitialiser la liste des présents
            absentStudents = [];  // Réinitialiser la liste des absents


            students.forEach((student, index) => {
                const status = document.getElementById(`textStatus-${index}`).textContent;
                if(status === "Présent") {
                    present++;
                    presentStudents.push(student.name); // Ajouter à la liste des présents
                }
                else if(status === "Fraudeur") fraude++;
                else {
                    absent++;
                    absentStudents.push(student.name); // Ajouter à la liste des absents
                }
            });

            document.getElementById('totalPresent').textContent = present;
            document.getElementById('totalAbsent').textContent = absent;
            document.getElementById('totalFraude').textContent = fraude;

            updatePresentListDisplay(); // Mettre à jour la liste des présents
            updateAbsentListDisplay();  // Mettre à jour la liste des absents
        }

        function updateFraudeListDisplay() {
            const fraudeListElement = document.getElementById('fraudeStudentList');
            fraudeListElement.innerHTML = ''; // Effacer la liste précédente

            fraudeStudents.forEach(studentName => {
                const li = document.createElement('li');
                li.textContent = studentName;
                fraudeListElement.appendChild(li);
            });
        }

        function updatePresentListDisplay() {
            const presentListElement = document.getElementById('presentStudentList');
            presentListElement.innerHTML = '';

            presentStudents.forEach(studentName => {
                const li = document.createElement('li');
                li.textContent = studentName;
                presentListElement.appendChild(li);
            });
        }

        function updateAbsentListDisplay() {
            const absentListElement = document.getElementById('absentStudentList');
            absentListElement.innerHTML = '';

            absentStudents.forEach(studentName => {
                const li = document.createElement('li');
                li.textContent = studentName;
                absentListElement.appendChild(li);
            });
        }


        function validateCode(index, value) {
            const row = document.getElementById(`row-${index}`);
            const statusTextElement = document.getElementById(`textStatus-${index}`);
            const statusSpanElement = document.getElementById(`status-${index}`);
            const codeInputElement = row.querySelector('.code-input');
            const studentName = students[index].name;


            if (value === students[index].code) {
                row.classList.add('valid');
                row.classList.remove('invalid');
                statusTextElement.innerText = "Présent";
                codeInputElement.style.display = 'none';
                statusSpanElement.style.display = 'inline';

                // Retirer de la liste fraude, si présent
                fraudeStudents = fraudeStudents.filter(name => name !== studentName);


            } else if (value.length >= 6) {
                row.classList.add('invalid');
                row.classList.remove('valid');
                statusTextElement.innerText = "Fraudeur";
                codeInputElement.style.display = 'inline';
                statusSpanElement.style.display = 'none';

                // Ajouter à la liste fraude, si non présent
                if (!fraudeStudents.includes(studentName)) {
                    fraudeStudents.push(studentName);
                }
            } else {
                row.classList.remove('valid', 'invalid');
                statusTextElement.innerText = "Absent";
                codeInputElement.style.display = 'inline';
                statusSpanElement.style.display = 'none';

                // Retirer de la liste fraude, si présent
                fraudeStudents = fraudeStudents.filter(name => name !== studentName);
            }

            updateTotals();
            updateFraudeListDisplay(); // Mettre à jour la liste des frauduleux
        }


        // Initialiser le tableau, les totaux et les listes
        renderList();
        updateTotals();
        updateFraudeListDisplay();
        updatePresentListDisplay();
        updateAbsentListDisplay();


    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bouton de capture d'écran flottant (image 3cm max)</title>
    <style>
        .floating-image-button {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            cursor: pointer;
            z-index: 1000;
            user-select: none;
            max-width: 3cm; /* Dimension maximale en largeur */
            max-height: 3cm; /* Dimension maximale en hauteur */
            width: auto; /* Conserve la proportion */
            height: auto; /* Conserve la proportion */
        }

        .floating-image-button:hover {
            opacity: 0.9;
        }
    </style>
</head>
<body>

    <img src="https://raw.githubusercontent.com/HansHugoHMB/Images/main/Digi.png" alt="Bouton de capture" class="floating-image-button" onclick="capturePage()">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        function capturePage() {
            html2canvas(document.body).then(canvas => {
                const link = document.createElement('a');
                link.download = 'capture_ecran.png';
                link.href = canvas.toDataURL();
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });
        }
    </script>


</script>

<!DOCTYPE html>
<html>
<head>
    <title>Inscription à la Newsletter HMB-TECH</title>
    <style>
        body {
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #21618c; /* Couleur de fond sombre (similaire à la capture d'écran) */
            position: relative; /* Needed for overlay positioning */
        }

        #newsletterContainer {
            background-color: #0A1929; /* Couleur de fond sombre du newsletter */
            color: #fff; /* Texte blanc */
            padding: 30px;
            border-radius: 8px;
            text-align: left; /* Aligner le texte à gauche */
            z-index: 0; /* S'assurer que le newsletter est au-dessus du fond flou (si activé) */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Ajouter une légère ombre */
        }
        .newsletter-title {
            font-size: 0.8em;
            color: #818CF8; /* Couleur violet clair */
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        .newsletter-subtitle {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 20px;
        }
        .checkbox-group {
            margin-bottom: 15px;
        }
        .checkbox-group label {
            display: block;
            margin-bottom: 8px;
            color: #E2E8F0; /* Couleur de texte plus claire */
            font-size: 0.9em;
        }
        .checkbox-group input[type="checkbox"] {
            margin-right: 10px;
        }
        #newsletterForm div {
            margin-bottom: 15px;
        }
        label[for="email"] {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #E2E8F0;
            font-size: 0.9em;
        }
        input[type="email"] {
            width: calc(100% - 22px);
            padding: 12px;
            border: 1px solid #1E293B; /* Bordure assortie au fond */
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 1em;
            background-color: #1E293B; /* Fond de l'input assorti au fond */
            color: #CBD5E0; /* Couleur du texte dans l'input */
        }
        button[type="submit"] {
            background-color: #A78BFA; /* Couleur violette du bouton */
            color: white;
            padding: 14px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            width: 100%;
        }
        button[type="submit"]:hover {
            background-color: #8B5CF6; /* Nuance de violet au survol */
        }
        #errorMessage {
            display: none;
            color: #C00000; /* Rouge pour le message d'erreur */
            margin-top: 10px;
            text-align: center;
        }
        #overlayConfirmation {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.5); /* Fond semi-transparent pour l'overlay */
            color: white;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 80%; /* Largeur du tableau central */
            max-width: 400px; /* Largeur maximale */
            padding: 30px;
            border-radius: 8px;
            background-color: #fff; /* Fond blanc pour le tableau */
            color: #333; /* Couleur du texte dans le tableau */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
        #overlayConfirmation.show {
            opacity: 1;
            visibility: visible;
        }
        #overlayMessage {
            font-size: 1.2em;
            font-weight: bold;
        }
        .copyright {
            font-size: 0.7em;
            color: #64748B; /* Couleur grise claire pour le copyright */
            margin-top: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="newsletterContainer">
        <div class="newsletter-title">VOTRE NEWSLETTER PERSONNALISÉE</div>
        <div class="newsletter-subtitle">Recevez le meilleur de l'actu</div>
        <div class="checkbox-group">
            <label>
                <input type="checkbox" name="frequency" value="daily" checked> Tous les jours
            </label>
            <label>
                <input type="checkbox" name="frequency" value="weekly" checked> Hebdo
            </label>
            <label>
                <input type="checkbox" name="frequency" value="special"> Spéciale bons plans
            </label>
        </div>
        <form id="newsletterForm">
            <div>
                <label for="email">Votre adresse e-mail</label>
                <input type="email" id="email" name="email" required>
            </div>
            <button type="submit">Envoyer</button>
            <div id="errorMessage">Une erreur s'est produite. Veuillez réessayer.</div>
        </form>
        <div class="copyright">© HMB-TECH –·– TOUT DROIT RÉSERVÉS</div>
    </div>

    <div id="overlayConfirmation">
        <div id="overlayMessage"></div>
    </div>

    <script type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
       (function(){
          emailjs.init("2U-zyFgLydFeBZ3pD"); // API Public
       })();

       document.addEventListener('DOMContentLoaded', function() {
           const form = document.getElementById('newsletterForm');
           const overlayConfirmation = document.getElementById('overlayConfirmation');
           const overlayMessage = document.getElementById('overlayMessage');
           const errorMessage = document.getElementById('errorMessage');
           const newsletterContainer = document.getElementById('newsletterContainer');
           const emailInput = document.getElementById('email'); // Récupérer l'élément input de l'e-mail

           // Initially hide messages
           errorMessage.style.display = 'none';

           form.addEventListener('submit', function(event) {
               event.preventDefault(); // Empêche la soumission par défaut du formulaire

               const email = emailInput.value; // Récupérer la valeur de l'e-mail ici

               const serviceID = "service_i4ab3qv"; // Service ID
               const templateIDForAdmin = "template_8xgvkg9"; // Template ID

               const paramsToAdmin = {
                   email: email
               };

               emailjs.send(serviceID, templateIDForAdmin, paramsToAdmin)
                   .then(function(response) {
                       console.log('SUCCESS!', response.status, response.text);
                       errorMessage.style.display = 'none';
                       overlayMessage.textContent = "Votre abonnement à HMB-TECH a réussi !";
                       overlayConfirmation.classList.add('show'); // Affiche l'overlay

                       // Optionnel : Masquer l'overlay après quelques secondes
                       setTimeout(function() {
                           overlayConfirmation.classList.remove('show');
                       }, 3000); // 3000 millisecondes = 2 secondes

                       // NE PAS effacer le champ e-mail ici
                       // form.reset();
                   }, function(error) {
                       console.error('FAILED...', error);
                       errorMessage.style.display = 'block';
                       overlayConfirmation.classList.remove('show');
                   });
           });
       });
    </script>
</body>
</html>



<!-- Inclusion de jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

<script>
function genererStatsPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    // Titre du document
    doc.setFontSize(14);
    doc.text("Statistiques de Présence", 14, 10);

    // Récupération des listes d'étudiants
    const presents = Array.from(document.getElementById('presentStudentList').children).map(li => [li.textContent]);
    const absents = Array.from(document.getElementById('absentStudentList').children).map(li => [li.textContent]);
    const fraudes = Array.from(document.getElementById('fraudeStudentList').children).map(li => [li.textContent]);

    // Déterminer le nombre maximum de lignes
    const maxRows = Math.max(presents.length, absents.length, fraudes.length);
    const rows = [];

    for (let i = 0; i < maxRows; i++) {
        rows.push([
            absents[i] ? absents[i][0] : '',
            presents[i] ? presents[i][0] : '',
            fraudes[i] ? fraudes[i][0] : ''
        ]);
    }

    // Génération du tableau PDF
    doc.autoTable({
        head: [["Absents", "Présents", "Fraudes"]],
        body: rows,
        startY: 20,
        theme: 'grid',
        styles: { fontSize: 10 },
        columnStyles: { 0: { cellWidth: 60 }, 1: { cellWidth: 60 }, 2: { cellWidth: 60 } }
    });

    // Enregistrement du fichier PDF
    doc.save("statistiques_presences.pdf");
}
</script>

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport de Présences</title>
    <style>
        body {
            font-family: sans-serif;
            margin-bottom: 250px; /* Adjust margin to accommodate fixed buttons */
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        #presentStudentList, #absentStudentList, #fraudeStudentList {
            margin-top: 20px;
            border: 1px solid #ccc;
            padding: 10px;
        }

        #presentStudentList h2, #absentStudentList h2, #fraudeStudentList h2 {
            margin-top: 0;
        }

        #presentStudentList li, #absentStudentList li, #fraudeStudentList li {
            list-style-type: none;
            padding: 5px 0;
            border-bottom: 1px dotted #eee;
        }

        #presentStudentList li:last-child, #absentStudentList li:last-child, #fraudeStudentList li:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>

    <h1>Liste des Étudiants</h1>

    <table id="studentList">
        <thead>
            <tr>
                <th>N°</th>
                <th>Nom</th>
                <th>Code</th>
                <th>Statut</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>John Doe</td>
                <td>JD123</td>
                <td>Présent</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Jane Smith</td>
                <td>JS456</td>
                <td>Absent</td>
            </tr>
            <tr>
                <td>3</td>
                <td>Peter Jones</td>
                <td>PJ789</td>
                <td>Présent</td>
            </tr>
            <tr>
                <td>4</td>
                <td>Alice Brown</td>
                <td>AB012</td>
                <td>Fraude</td>
            </tr>
            </tbody>
    </table>

    <h2>Listes pour les statistiques (pour démonstration)</h2>
    <div id="presentStudentList">
        <h2>Présents</h2>
        <ul>
            <li>John Doe</li>
            <li>Peter Jones</li>
            </ul>
    </div>

    <div id="absentStudentList">
        <h2>Absents</h2>
        <ul>
            <li>Jane Smith</li>
            </ul>
    </div>

    <div id="fraudeStudentList">
        <h2>Fraudes</h2>
        <ul>
            <li>Alice Brown</li>
            </ul>
    </div>

    <button onclick="generatePresencePDF()"
            style="position: fixed; bottom: 200px; right: 20px; padding: 10px; background: #B0E2FF; color: white; border: none; border-radius: 5px; cursor: pointer;">
        ⎙ Rapport de Présences
    </button>

    <button onclick="genererStatsPDF()"
            style="position: fixed;
                   right: 20px;
                   bottom: 20px;
                   width: 50px;
                   height: 50px;
                   background: #0077B5;
                   color: white;
                   border: none;
                   border-radius: 50%;
                   cursor: pointer;
                   font-size: 16px;">
        📊
    </button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

    <script>
        function generatePresencePDF() {
            const doc = new jspdf.jsPDF({
                orientation: 'PORTRAIT',
                unit: 'mm',
                format: 'a4'
            });

            // Configuration du PDF
            const title = "RAPPORT DES PRÉSENCES PRÉPA H-25 - " + new Date().toLocaleDateString();
            const headers = [["N°", "Nom", "Statut"]];
            const rows =;

            // Récupération des données du tableau
            const tableRows = document.querySelectorAll('#studentList tr');

            tableRows.forEach((row, index) => {
                if (index === 0) return; // Skip header row
                const cells = row.querySelectorAll('td');
                if (cells.length >= 4) {
                    const status = cells[3].textContent; // Colonne Statut
                    const rowData = [
                        index,
                        cells[1].textContent, // Nom
                        status
                    ];
                    rows.push(rowData);
                }
            });

            // Génération du tableau PDF
            doc.autoTable({
                head: headers,
                body: rows,
                theme: 'grid',
                styles: { fontSize: 10 },
                headerStyles: { fillColor: [33, 150, 243] },
                alternateRowStyles: { fillColor: [240, 240, 240] },
                margin: { top: 20 },
                didDrawPage: function(data) {
                    // En-tête avec date
                    doc.setFontSize(12);
                    doc.text(title, 14, 10);

                    // Pied de page
                    const pageCount = doc.internal.getNumberOfPages();
                    doc.setFontSize(8);
                    doc.text(`Page ${data.pageNumber}/${pageCount} - © HMB-TECH ${new Date().getFullYear()}`,
                             data.settings.margin.left, doc.internal.pageSize.height - 5);
                }
            });

            doc.save(`presences-${Date.now()}.pdf`);
        }
    </script>

    <script>
        function genererStatsPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Titre du document
            doc.setFontSize(14);
            doc.text("Statistiques de Présence", 14, 10);

            // Récupération des listes d'étudiants
            const presents = Array.from(document.getElementById('presentStudentList').children).map(li => [li.textContent]);
            const absents = Array.from(document.getElementById('absentStudentList').children).map(li => [li.textContent]);
            const fraudes = Array.from(document.getElementById('fraudeStudentList').children).map(li => [li.textContent]);

            // Déterminer le nombre maximum de lignes
            const maxRows = Math.max(presents.length, absents.length, fraudes.length);
            const rows =;

            for (let i = 0; i < maxRows; i++) {
                rows.push([
                    absents[i] ? absents[i][0] : '',
                    presents[i] ? presents[i][0] : '',
                    fraudes[i] ? fraudes[i][0] : ''
                ]);
            }

            // Génération du tableau PDF
            doc.autoTable({
                head: [["Absents", "Présents", "Fraudes"]],
                body: rows,
                startY: 20,
                theme: 'grid',
                styles: { fontSize: 10 },
                columnStyles: { 0: { cellWidth: 60 }, 1: { cellWidth: 60 }, 2: { cellWidth: 60 } }
            });

            // Enregistrement du fichier PDF
            doc.save("statistiques_presences.pdf");
        }
    </script>

</body>
</html>

